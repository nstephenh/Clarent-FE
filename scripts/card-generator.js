const axios = require("axios");
const fs = require("fs");

const url = "https://api.gatcg.com/cards/search?name=&page=";
const outputFile = "src/constants/cardList.ts";

async function downloadCards() {

  let cardUUIDs = [];

  let page = 0;
  let done = false;
  while (!done) {
    const jsonString = await axios.get(url + page.toString());
    page = jsonString.data.page + 1;
    done = !(jsonString.data.has_more);
    const cards = jsonString.data.data;
    cards.map((card) => {
      console.log(card.name, card.uuid);
      cardUUIDs.push(card.uuid);
    });
  }

  const exportData = `// This file is generated by the card-generator script. Do not edit it manually. \nexport const CARD_LIST: string[] = ${JSON.stringify(
    cardUUIDs,
    null,
    2
  )};`;

  fs.mkdirSync("../src/constants", { recursive: true }); // create the constants directory if it doesn't exist
  fs.writeFileSync(outputFile, exportData);
}

downloadCards();